<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Video Downloader for Bluesky</title>
    <meta property="og:title" content="Video Downloader for Bluesky" />
    <meta name="twitter:title" content="Video Downloader for Bluesky" />
    <meta
      name="description"
      content="Download (and convert!) Bluesky videos with ease!"
    />
    <meta
      property="og:description"
      content="Download (and convert!) Bluesky videos with ease!"
    />
    <meta
      name="twitter:description"
      content="Download (and convert!) Bluesky videos with ease!"
    />
    <meta
      property="og:image"
      content="https://downloader.notx.blue/share.png"
    />
    <meta
      name="twitter:image"
      content="https://downloader.notx.blue/share.png"
    />
    <link href="res/tailwind.min.css" rel="stylesheet" />
    <style>
      .text-blue-bsky {
        color: rgb(32, 139, 254);
      }

      .bg-blue-bsky {
        background-color: rgb(32, 139, 254);
      }

      .bg-blue-kofi {
        background-color: #13c3ff;
      }

      .bg-orange-apoiase {
        background-color: #ec4b3c;
      }

      .player {
        max-width: 480px;
        width: 100%;
        margin: 0 auto;
      }
    </style>
    <script src="res/ffmpeg.min.js"></script>
    <script src="res/vue.min.js"></script>
    <link
      rel="icon"
      href="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text y=%22.9em%22 font-size=%2290%22&gt;⬇️&lt;/text&gt;&lt;/svg&gt;"
    />
  </head>

  <body class="bg-gray-100 text-gray-900 p-4">
    <a
      href="https://share.notx.blue/"
      target="_blank"
      ref="alert"
      rel="noopener"
      class="block bg-blue-100 text-blue-800 px-4 -m-4 py-2 text-xs"
    >
      💙 Easily share from ANY website to Bluesky: install the
      <span class="inline-block font-bold border-solid border-b border-blue-800"
        >Redirect Twitter Share to Bluesky</span
      >
      extension. Available for Chrome and Firefox.
    </a>
    <div class="mt-10 mb-5">
      <svg
        class="w-full max-w-xl mx-auto"
        viewBox="0 0 1144 146"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M1072.75 142.188C1066.63 142.188 1062.08 141.602 1059.08 140.43C1056.15 139.193 1054.69 137.044 1054.69 133.984C1054.69 132.747 1054.92 131.803 1055.37 131.152C1055.89 130.501 1056.8 129.98 1058.11 129.59C1061.1 128.809 1063.09 127.767 1064.06 126.465C1065.04 125.163 1065.53 122.949 1065.53 119.824V73.8281C1065.53 70.1172 1065.01 67.6432 1063.96 66.4062C1062.92 65.1693 1060.77 64.5508 1057.52 64.5508C1055.83 64.5508 1054.62 64.2578 1053.91 63.6719C1053.26 63.0859 1052.93 62.0443 1052.93 60.5469C1052.93 57.5521 1054.56 55.0781 1057.81 53.125C1061.13 51.1068 1067.97 48.2747 1078.32 44.6289C1080.79 43.7826 1082.81 43.1641 1084.38 42.7734C1086 42.3828 1087.43 42.2526 1088.67 42.3828C1089.97 42.513 1090.98 42.7734 1091.7 43.1641C1092.42 43.4896 1093.1 44.3034 1093.75 45.6055C1094.47 46.8424 1094.99 48.0794 1095.31 49.3164C1095.7 50.4883 1096.22 52.3112 1096.88 54.7852L1097.75 58.3984C1101.14 53.3203 1105.05 49.2513 1109.47 46.1914C1113.96 43.1315 1118.65 41.6016 1123.54 41.6016C1129.85 41.6016 1134.83 43.4245 1138.48 47.0703C1142.12 50.7161 1143.95 55.7617 1143.95 62.207C1143.95 67.6107 1142.48 71.6471 1139.55 74.3164C1136.62 76.9206 1132.88 78.2227 1128.32 78.2227C1123.44 78.2227 1119.5 75.944 1116.5 71.3867C1115.2 69.2383 1113.96 67.7083 1112.79 66.7969C1111.62 65.8854 1110.12 65.4297 1108.3 65.4297C1105.96 65.4297 1103.48 66.5365 1100.88 68.75L1101.07 120.41C1101.14 123.861 1101.89 126.204 1103.32 127.441C1104.82 128.613 1107.68 129.395 1111.91 129.785C1114.45 129.98 1115.72 131.315 1115.72 133.789C1115.72 136.784 1114.42 138.932 1111.82 140.234C1109.28 141.536 1105.05 142.188 1099.12 142.188H1072.75Z"
          fill="#208BFE"
        />
        <path
          d="M1001.07 145.801C990.853 145.801 981.608 143.522 973.34 138.965C965.137 134.342 958.757 128.158 954.199 120.41C949.707 112.663 947.461 104.134 947.461 94.8242C947.461 84.4727 949.87 75.2279 954.688 67.0898C959.505 58.9518 966.016 52.7018 974.219 48.3398C982.422 43.9779 991.504 41.7969 1001.46 41.7969C1012.34 41.7969 1021.65 44.5638 1029.39 50.0977C1037.14 55.5664 1042.35 63.2487 1045.02 73.1445C1046.45 78.0273 1046.58 81.6732 1045.41 84.082C1044.3 86.4258 1041.57 88.3138 1037.21 89.7461C1024.51 93.7826 1005.79 97.0703 981.055 99.6094C982.812 107.552 986.003 113.477 990.625 117.383C995.247 121.224 1001.66 123.145 1009.86 123.145C1018.46 123.145 1026.33 120.703 1033.5 115.82C1038.38 113.216 1041.57 113.281 1043.07 116.016C1043.65 117.318 1043.59 119.043 1042.87 121.191C1042.15 123.34 1041.02 125.391 1039.45 127.344C1035.22 133.333 1029.82 137.923 1023.24 141.113C1016.73 144.238 1009.34 145.801 1001.07 145.801ZM979.688 83.2031V87.0117C992.448 85.4492 1001.76 84.1146 1007.62 83.0078C1009.9 82.6172 1011.39 82.0312 1012.11 81.25C1012.89 80.4688 1013.28 79.1667 1013.28 77.3438C1012.76 71.3542 1010.94 66.4714 1007.81 62.6953C1004.75 58.9193 1000.98 57.0312 996.484 57.0312C991.211 57.0312 987.077 59.4076 984.082 64.1602C981.152 68.9128 979.688 75.2604 979.688 83.2031Z"
          fill="#208BFE"
        />
        <path
          d="M869.629 145.41C863.574 145.41 857.812 144.303 852.344 142.09C846.94 139.811 842.188 136.621 838.086 132.52C834.049 128.418 830.827 123.307 828.418 117.188C826.009 111.003 824.805 104.199 824.805 96.7773C824.805 80.5664 829.557 67.4805 839.062 57.5195C848.568 47.5586 861.003 42.5781 876.367 42.5781C882.617 42.5781 888.574 43.6523 894.238 45.8008V30.1758C894.238 26.7904 893.62 24.5768 892.383 23.5352C891.211 22.4935 888.607 21.9727 884.57 21.9727C882.747 21.9727 881.445 21.6471 880.664 20.9961C879.948 20.3451 879.59 19.2708 879.59 17.7734C879.59 15.2995 881.25 13.2161 884.57 11.5234C887.956 9.83073 894.629 7.51953 904.59 4.58984C906.673 4.06901 908.919 3.45052 911.328 2.73438C913.737 2.01823 915.495 1.4974 916.602 1.17188C917.773 0.846354 918.945 0.585938 920.117 0.390625C921.354 0.130208 922.461 0 923.438 0C924.74 0 925.781 0.130208 926.562 0.390625C927.344 0.651042 927.962 0.94401 928.418 1.26953C928.874 1.59505 929.199 2.27865 929.395 3.32031C929.59 4.29688 929.688 5.14323 929.688 5.85938C929.753 6.51042 929.785 7.7474 929.785 9.57031V122.363C929.785 124.251 930.111 125.618 930.762 126.465C931.413 127.311 932.552 127.767 934.18 127.832C936.003 127.897 937.272 127.995 937.988 128.125C938.704 128.255 939.355 128.581 939.941 129.102C940.527 129.557 940.82 130.306 940.82 131.348C940.82 135.319 938.509 138.639 933.887 141.309C929.264 143.913 923.763 145.215 917.383 145.215C912.565 145.215 908.268 144.108 904.492 141.895C900.716 139.681 898.079 136.523 896.582 132.422C889.29 141.081 880.306 145.41 869.629 145.41ZM860.156 84.9609C860.156 97.0052 862.24 106.576 866.406 113.672C870.573 120.703 876.042 124.219 882.812 124.219C887.174 124.219 890.983 122.689 894.238 119.629V63.7695C889.421 60.319 884.212 58.5938 878.613 58.5938C873.014 58.5938 868.522 61.0026 865.137 65.8203C861.816 70.5729 860.156 76.9531 860.156 84.9609Z"
          fill="#208BFE"
        />
        <path
          d="M795.605 145.215C790.202 145.215 785.677 143.978 782.031 141.504C778.385 139.03 776.237 135.384 775.586 130.566C768.164 140.853 758.171 145.996 745.605 145.996C737.337 145.996 730.599 143.555 725.391 138.672C720.182 133.724 717.578 127.148 717.578 118.945C717.578 108.203 722.526 99.6745 732.422 93.3594C742.318 87.0443 756.185 83.2031 774.023 81.8359V75.5859C774.023 69.9219 772.689 65.5924 770.02 62.5977C767.415 59.5378 763.867 58.0078 759.375 58.0078C755.078 58.0078 751.921 58.8542 749.902 60.5469C747.949 62.2396 746.387 65.5924 745.215 70.6055C744.108 74.3815 742.318 77.1159 739.844 78.8086C737.435 80.5013 734.212 81.3477 730.176 81.3477C721.777 81.3477 717.578 77.8971 717.578 70.9961C717.578 66.1133 720.052 61.3932 725 56.8359C729.948 52.2786 736.458 48.6003 744.531 45.8008C752.604 43.0013 760.97 41.6016 769.629 41.6016C781.348 41.6016 790.853 44.5312 798.145 50.3906C805.436 56.1849 809.049 64.1927 808.984 74.4141V122.363C808.984 124.316 809.31 125.716 809.961 126.562C810.677 127.409 811.816 127.832 813.379 127.832C815.137 127.897 816.374 128.027 817.09 128.223C817.871 128.353 818.49 128.711 818.945 129.297C819.401 129.818 819.629 130.664 819.629 131.836C819.629 135.482 817.35 138.639 812.793 141.309C808.301 143.913 802.572 145.215 795.605 145.215ZM749.414 113.184C749.349 117.546 750.326 120.931 752.344 123.34C754.362 125.749 757.064 126.953 760.449 126.953C765.202 126.953 769.727 124.707 774.023 120.215V92.3828C766.471 93.4245 760.482 95.6706 756.055 99.1211C751.628 102.507 749.414 107.194 749.414 113.184Z"
          fill="#208BFE"
        />
        <path
          d="M653.418 145.41C643.327 145.41 634.18 143.197 625.977 138.77C617.773 134.277 611.361 128.125 606.738 120.312C602.116 112.5 599.805 103.776 599.805 94.1406C599.805 79.1016 605.078 66.6016 615.625 56.6406C626.237 46.6146 639.421 41.6016 655.176 41.6016C670.28 41.6016 682.878 46.4844 692.969 56.25C703.125 66.0156 708.203 78.1901 708.203 92.7734C708.203 102.799 705.762 111.849 700.879 119.922C696.061 127.93 689.486 134.18 681.152 138.672C672.819 143.164 663.574 145.41 653.418 145.41ZM633.789 80.7617C633.789 88.0534 634.831 95.4427 636.914 102.93C639.062 110.352 642.025 116.602 645.801 121.68C649.642 126.758 653.711 129.329 658.008 129.395C662.956 129.395 666.862 127.311 669.727 123.145C672.591 118.913 674.023 113.184 674.023 105.957C674.023 98.5352 672.949 91.1458 670.801 83.7891C668.717 76.3672 665.788 70.1823 662.012 65.2344C658.301 60.2865 654.297 57.8125 650 57.8125C645.052 57.8125 641.113 59.8633 638.184 63.9648C635.254 68.0664 633.789 73.6654 633.789 80.7617Z"
          fill="#208BFE"
        />
        <path
          d="M553.027 142.188C546.582 142.188 541.992 141.569 539.258 140.332C536.589 139.03 535.254 136.914 535.254 133.984C535.254 131.576 536.426 130.111 538.77 129.59C541.699 128.874 543.717 127.865 544.824 126.562C545.996 125.195 546.582 122.949 546.582 119.824L546.387 33.5938C546.387 29.8828 545.833 27.3763 544.727 26.0742C543.685 24.707 541.243 24.0234 537.402 24.0234C535.71 24.0234 534.505 23.7305 533.789 23.1445C533.138 22.5586 532.812 21.5169 532.812 20.0195C532.812 16.9596 534.44 14.5508 537.695 12.793C540.951 11.0352 548.047 8.43099 558.984 4.98047C564.974 3.09245 569.01 1.85547 571.094 1.26953C573.242 0.683594 575.163 0.390625 576.855 0.390625C579.46 0.390625 581.055 0.94401 581.641 2.05078C582.292 3.09245 582.617 5.40365 582.617 8.98438C582.292 19.401 582.096 30.7617 582.031 43.0664C581.966 55.306 581.966 69.8893 582.031 86.8164C582.161 103.678 582.227 115.072 582.227 120.996C582.227 123.991 582.682 126.042 583.594 127.148C584.505 128.255 586.361 129.069 589.16 129.59C591.439 130.111 592.578 131.576 592.578 133.984C592.578 136.914 591.243 139.03 588.574 140.332C585.97 141.569 581.641 142.188 575.586 142.188H553.027Z"
          fill="#208BFE"
        />
        <path
          d="M488.281 142.188C482.878 142.188 478.906 141.569 476.367 140.332C473.893 139.03 472.656 136.914 472.656 133.984C472.656 131.771 473.665 130.241 475.684 129.395C477.897 129.004 479.427 128.19 480.273 126.953C481.185 125.651 481.641 123.73 481.641 121.191V82.8125C481.641 70.1172 476.855 63.7695 467.285 63.7695C461.686 63.7695 456.868 65.6576 452.832 69.4336L453.027 121.387C453.027 124.316 453.418 126.335 454.199 127.441C454.98 128.483 456.478 129.199 458.691 129.59C460.97 129.98 462.109 131.38 462.109 133.789C462.109 136.719 460.84 138.867 458.301 140.234C455.827 141.536 451.888 142.188 446.484 142.188H424.023C417.904 142.188 413.477 141.536 410.742 140.234C408.008 138.932 406.641 136.784 406.641 133.789C406.641 131.185 407.78 129.525 410.059 128.809C412.858 128.158 414.779 127.116 415.82 125.684C416.927 124.251 417.48 122.168 417.48 119.434L417.285 73.1445C417.285 69.5638 416.764 67.2526 415.723 66.2109C414.681 65.1042 412.533 64.5508 409.277 64.5508C407.715 64.4206 406.641 64.0951 406.055 63.5742C405.534 63.0534 405.273 62.0443 405.273 60.5469C405.273 57.4219 406.966 54.8177 410.352 52.7344C413.802 50.5859 420.182 47.8841 429.492 44.6289C433.073 43.3919 435.872 42.6432 437.891 42.3828C439.909 42.0573 441.634 42.3828 443.066 43.3594C444.499 44.3359 445.54 45.638 446.191 47.2656C446.908 48.8281 447.786 51.3346 448.828 54.7852L449.902 58.2031C454.915 52.7995 460.742 48.6654 467.383 45.8008C474.023 42.8711 480.859 41.4062 487.891 41.4062C496.615 41.4062 503.776 44.1732 509.375 49.707C514.974 55.2409 517.676 63.2812 517.48 73.8281C517.09 89.6484 516.895 105.176 516.895 120.41C516.895 123.535 517.318 125.716 518.164 126.953C519.01 128.19 520.703 129.004 523.242 129.395C525.521 129.785 526.66 131.315 526.66 133.984C526.66 136.784 525.358 138.867 522.754 140.234C520.15 141.536 515.918 142.188 510.059 142.188H488.281Z"
          fill="#208BFE"
        />
        <path
          d="M290.234 144.824C285.742 144.824 282.389 144.499 280.176 143.848C278.027 143.197 276.27 141.992 274.902 140.234C273.535 138.477 272.07 135.579 270.508 131.543C264.323 114.551 256.576 93.0339 247.266 66.9922C246.029 63.737 244.857 61.4909 243.75 60.2539C242.643 58.9519 240.951 58.2032 238.672 58.0078C236.654 57.6172 235.645 56.1524 235.645 53.6133C235.645 50.8138 236.979 48.7956 239.648 47.5586C242.318 46.2565 246.647 45.6055 252.637 45.6055H279.492C284.635 45.6055 288.346 46.224 290.625 47.461C292.904 48.698 294.043 50.6836 294.043 53.418C294.043 54.8503 293.75 55.8594 293.164 56.4453C292.643 56.9662 291.732 57.2917 290.43 57.4219C287.24 57.6172 285.254 58.431 284.473 59.8633C283.691 61.2956 283.822 63.6719 284.863 66.9922L296.094 103.223C296.419 104.134 296.875 105.729 297.461 108.008L310.254 67.3828C311.1 64.7787 310.807 62.1745 309.375 59.5703C307.943 56.9662 307.292 55.0456 307.422 53.8086C307.617 51.3347 308.757 49.5118 310.84 48.3399C312.923 47.1029 317.057 46.0612 323.242 45.2149C326.302 44.8894 328.874 44.7266 330.957 44.7266C333.04 44.6615 334.863 44.8243 336.426 45.2149C338.053 45.5404 339.323 45.9636 340.234 46.4844C341.211 46.9401 342.057 47.7865 342.773 49.0235C343.555 50.1953 344.141 51.3998 344.531 52.6368C344.987 53.8086 345.508 55.4688 346.094 57.6172L360.254 101.758L362.109 108.398L373.633 66.7969C374.544 63.5417 374.512 61.2305 373.535 59.8633C372.559 58.431 370.15 57.6823 366.309 57.6172C364.811 57.487 363.737 57.1289 363.086 56.543C362.435 55.892 362.109 54.8503 362.109 53.418C362.109 48.2097 366.699 45.6055 375.879 45.6055H387.891C396.94 45.6055 401.465 48.1446 401.465 53.2227C401.465 54.655 401.204 55.6966 400.684 56.3477C400.228 56.9987 399.414 57.3568 398.242 57.4219C396.094 57.6172 394.368 58.4961 393.066 60.0586C391.764 61.6211 390.43 64.323 389.062 68.1641L370.508 125.195C368.685 131.12 367.546 135.254 367.09 137.598C366.504 140.332 365.365 142.22 363.672 143.262C361.979 144.303 359.31 144.824 355.664 144.824C350.977 144.824 347.396 144.434 344.922 143.652C342.513 142.871 340.658 141.667 339.355 140.039C338.053 138.346 336.882 135.742 335.84 132.227C327.376 108.138 321.712 92.3177 318.848 84.7657L305.078 125.781C303.451 131.12 302.441 135.059 302.051 137.598C301.595 140.397 300.456 142.285 298.633 143.262C296.875 144.303 294.076 144.824 290.234 144.824Z"
          fill="#208BFE"
        />
        <path
          d="M176.465 145.41C166.374 145.41 157.227 143.197 149.023 138.77C140.82 134.277 134.408 128.125 129.785 120.312C125.163 112.5 122.852 103.776 122.852 94.1406C122.852 79.1016 128.125 66.6016 138.672 56.6406C149.284 46.6146 162.467 41.6016 178.223 41.6016C193.327 41.6016 205.924 46.4844 216.016 56.25C226.172 66.0156 231.25 78.1901 231.25 92.7734C231.25 102.799 228.809 111.849 223.926 119.922C219.108 127.93 212.533 134.18 204.199 138.672C195.866 143.164 186.621 145.41 176.465 145.41ZM156.836 80.7617C156.836 88.0534 157.878 95.4427 159.961 102.93C162.109 110.352 165.072 116.602 168.848 121.68C172.689 126.758 176.758 129.329 181.055 129.395C186.003 129.395 189.909 127.311 192.773 123.145C195.638 118.913 197.07 113.184 197.07 105.957C197.07 98.5352 195.996 91.1458 193.848 83.7891C191.764 76.3672 188.835 70.1823 185.059 65.2344C181.348 60.2865 177.344 57.8125 173.047 57.8125C168.099 57.8125 164.16 59.8633 161.23 63.9648C158.301 68.0664 156.836 73.6654 156.836 80.7617Z"
          fill="#208BFE"
        />
        <path
          d="M44.8242 145.41C38.7695 145.41 33.0078 144.303 27.5391 142.09C22.1354 139.811 17.3828 136.621 13.2812 132.52C9.24479 128.418 6.02214 123.307 3.61328 117.188C1.20443 111.003 0 104.199 0 96.7773C0 80.5664 4.7526 67.4805 14.2578 57.5195C23.763 47.5586 36.1979 42.5781 51.5625 42.5781C57.8125 42.5781 63.7695 43.6523 69.4336 45.8008V30.1758C69.4336 26.7904 68.8151 24.5768 67.5781 23.5352C66.4062 22.4935 63.8021 21.9727 59.7656 21.9727C57.9427 21.9727 56.6406 21.6471 55.8594 20.9961C55.1432 20.3451 54.7852 19.2708 54.7852 17.7734C54.7852 15.2995 56.4453 13.2161 59.7656 11.5234C63.151 9.83073 69.8242 7.51953 79.7852 4.58984C81.8685 4.06901 84.1146 3.45052 86.5234 2.73438C88.9323 2.01823 90.6901 1.4974 91.7969 1.17188C92.9688 0.846354 94.1406 0.585938 95.3125 0.390625C96.5495 0.130208 97.6562 0 98.6328 0C99.9349 0 100.977 0.130208 101.758 0.390625C102.539 0.651042 103.158 0.94401 103.613 1.26953C104.069 1.59505 104.395 2.27865 104.59 3.32031C104.785 4.29688 104.883 5.14323 104.883 5.85938C104.948 6.51042 104.98 7.7474 104.98 9.57031V122.363C104.98 124.251 105.306 125.618 105.957 126.465C106.608 127.311 107.747 127.767 109.375 127.832C111.198 127.897 112.467 127.995 113.184 128.125C113.9 128.255 114.551 128.581 115.137 129.102C115.723 129.557 116.016 130.306 116.016 131.348C116.016 135.319 113.704 138.639 109.082 141.309C104.46 143.913 98.9583 145.215 92.5781 145.215C87.7604 145.215 83.4635 144.108 79.6875 141.895C75.9115 139.681 73.2747 136.523 71.7773 132.422C64.4857 141.081 55.5013 145.41 44.8242 145.41ZM35.3516 84.9609C35.3516 97.0052 37.4349 106.576 41.6016 113.672C45.7682 120.703 51.237 124.219 58.0078 124.219C62.3698 124.219 66.1784 122.689 69.4336 119.629V63.7695C64.6159 60.319 59.4076 58.5938 53.8086 58.5938C48.2096 58.5938 43.7174 61.0026 40.332 65.8203C37.0117 70.5729 35.3516 76.9531 35.3516 84.9609Z"
          fill="#208BFE"
        />
      </svg>
    </div>
    <div class="mb-2 text-center text-xs lowercase">
      Work in Progress. Expect bugs • part of
      <a href="https://notx.blue" class="text-blue-bsky">notx.blue</a> by
      <a href="https://bsky.app/profile/joseli.to" class="text-blue-bsky"
        >@joseli.to</a
      >
      •
      <a
        href="https://github.com/breakzplatform/downloader.notx.blue"
        class="text-blue-bsky font-bold"
        >View-source</a
      >
    </div>
    <div
      id="app"
      class="max-w-4xl mx-auto p-4 rounded-lg mt-6 bg-white shadow-md"
    >
      <p class="text-gray-600 text-center mb-6">
        <strong>Download (and convert!) Bluesky videos with ease!</strong> Enter
        a Bluesky post URL:
      </p>

      <form @submit.prevent="processVideo" class="mb-2 flex">
        <input
          v-model="postUrl"
          type="text"
          class="w-full p-2 border rounded flwx-grow mr-2 shadow bg-blue-50"
          placeholder="https://bsky.app/profile/kaelltx.bsky.social/post/3l4aiybdeoo2q"
          required
        />
        <button
          type="submit"
          :disabled="status.length > 0"
          class="bg-blue-bsky text-white rounded-full px-4 shadow hover:bg-blue-600 transition-colors flex items-center gap-2 font-bold"
        >
          <span class="mr-1">
            <svg
              fill="#fff"
              height="20px"
              width="20px"
              viewBox="0 0 29.978 29.978"
            >
              <g>
                <path
                  d="M25.462,19.105v6.848H4.515v-6.848H0.489v8.861c0,1.111,0.9,2.012,2.016,2.012h24.967c1.115,0,2.016-0.9,2.016-2.012
      v-8.861H25.462z"
                />
                <path
                  d="M14.62,18.426l-5.764-6.965c0,0-0.877-0.828,0.074-0.828s3.248,0,3.248,0s0-0.557,0-1.416c0-2.449,0-6.906,0-8.723
      c0,0-0.129-0.494,0.615-0.494c0.75,0,4.035,0,4.572,0c0.536,0,0.524,0.416,0.524,0.416c0,1.762,0,6.373,0,8.742
      c0,0.768,0,1.266,0,1.266s1.842,0,2.998,0c1.154,0,0.285,0.867,0.285,0.867s-4.904,6.51-5.588,7.193
      C15.092,18.979,14.62,18.426,14.62,18.426z"
                />
              </g>
            </svg>
          </span>
          <span>Start</span>
        </button>
      </form>

      <div class="my-4">
        <a
          v-if="downloadReady"
          :href="downloadLink"
          class="block w-full bg-green-600 text-white text-center py-2 rounded hover:bg-green-700 transition-colors mb-2 font-bold text-xl"
          download
          >Download Converted (.mp4)</a
        >

        <a
          v-if="originalDownloadLink"
          :href="originalDownloadLink"
          class="block w-full bg-green-500 text-white text-center py-2 rounded hover:bg-green-600 transition-colors mb-2 font-bold"
          download
          >Download Original (.ts)</a
        >

        <a
          v-if="downloadReady && subtitleUrl.length > 0"
          :href="subtitleUrl"
          class="block w-full bg-blue-500 text-white text-center py-2 rounded hover:bg-blue-600 transition-colors mb-2 text-sm font-bold"
          download
          >Download Subtitles ({{subtitleLang}}.vtt)</a
        >
      </div>

      <div
        v-if="progressBarVisible"
        class="w-full bg-gray-300 rounded h-8 mb-4"
      >
        <div
          class="bg-green-500 h-full rounded transition-all duration-300"
          :style="{ width: progress + '%' }"
        ></div>
      </div>
      <div v-if="status" class="text-center font-semibold mb-4 mt-4">
        {{ status }}
      </div>

      <div class="py-4" v-if="videoPreviewVisible">
        <video
          :key="postUrl"
          controls
          class="player rounded shadow overflow-hidden bg-black"
          preload="metadata"
        >
          <source :src="downloadLink" type="video/mp4" />
          <track
            :label="subtitleLang"
            kind="subtitles"
            v-if="downloadReady && subtitleUrl.length > 0"
            :srclang="subtitleLang"
            :src="subtitleUrl"
            default
          />
        </video>
      </div>

      <div class="mt-6 overflow-auto" v-if="urlHistory.length > 0">
        <table
          class="table-auto w-full bg-white shadow-md overflow-hidden rounded-lg"
        >
          <thead class="bg-blue-bsky text-white">
            <tr>
              <th class="px-4 py-2 border-b text-left text-xs" colspan="2">
                History
              </th>
            </tr>
          </thead>
          <tbody>
            <tr
              v-for="(url, index) in urlHistory"
              :key="url"
              :class="{
                'bg-gray-100': index % 2 !== 0,
                'bg-gray-50': index % 2 === 0
              }"
            >
              <td class="px-4 py-2 border-b">
                <a
                  :href="url"
                  class="text-blue-bsky border-b"
                  target="_blank"
                  rel="noopener"
                  >{{ url }}</a
                >
              </td>
              <td
                class="px-2 py-2 border-b text-right"
                style="min-width: 220px"
              >
                <button
                  class="bg-blue-bsky text-white px-3 py-2 mb-2 rounded-full font-bold hover:bg-blue-600 text-xs shadow"
                  @click="fillAndDownload(url)"
                >
                  Re-Download
                </button>
                <button
                  class="bg-red-500 text-white px-3 py-2 rounded-full font-bold hover:bg-red-600 ml-2 text-xs shadow"
                  @click="removeFromHistory(url)"
                >
                  Remove
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="mt-8 mb-6 text-center text-xs">
      <div class="lowercase mb-6">
        Directly from Brazil by Joselito, with much love and care. This site
        does not use any cookies or collect any data. This site is not related
        to Bluesky.
      </div>
      <div>
        <a
          href="https://apoia.se/joselito"
          target="_blank"
          rel="noopener"
          class="bg-orange-apoiase text-white px-3 font-mono py-2 rounded-full font-bold hover:bg-blue-600 ml-2 text-xs shadow"
          >APOIA.se</a
        >
        <a
          href="https://ko-fi.com/joselito"
          target="_blank"
          rel="noopener"
          class="bg-blue-kofi text-white px-3 py-2 font-mono rounded-full font-bold hover:bg-blue-600 ml-2 text-xs shadow"
          >Ko-fi</a
        >
        <a
          href="https://github.com/sponsors/breakzplatform"
          target="_blank"
          rel="noopener"
          class="bg-gray-700 text-white px-3 py-2 font-mono rounded-full font-bold hover:bg-blue-600 ml-2 text-xs shadow"
          >GitHub</a
        >
      </div>
    </div>
    <div class="mb-6 text-center text-xs lowercase">
      Respect copyright and Bluesky's terms of service.
    </div>
    <script>
      const { createFFmpeg, fetchFile } = FFmpeg;

      Vue.createApp({
        data() {
          return {
            ffmpeg: null,
            postUrl: "",
            status: "",
            progress: 0,
            convertProgress: 0,
            progressBarVisible: false,
            thumbnailVisible: false,
            videoPreviewVisible: false,
            videoPreviewUrl: "",
            downloadReady: false,
            originalDownloadLink: "",
            downloadLink: "",
            urlHistory: [], // List of URLs stored in localStorage
            subtitleLang: "",
            subtitleUrl: "",
          };
        },
        async mounted() {
          // Load history from localStorage
          this.loadHistory();

          this.ffmpeg = createFFmpeg({
            log: false,
            progress: ({ ratio }) => {
              this.progress = parseInt((ratio * 100).toFixed(2) / 2) + 50;
            },
          });

          if (!this.ffmpeg.isLoaded()) this.ffmpeg.load();

          // Check for the 'url' query parameter and set postUrl
          const urlParams = new URLSearchParams(window.location.search);
          const url = urlParams.get("url");
          if (url) {
            this.postUrl = url;
            this.processVideo(); // Automatically run processVideo if the url is filled
          }
        },
        methods: {
          loadHistory() {
            // Load the saved URLs from localStorage
            const savedHistory =
              JSON.parse(localStorage.getItem("urlHistory")) || [];
            this.urlHistory = savedHistory.slice(0, 20); // Keep only the last 20 URLs
          },
          saveToHistory(url) {
            // Check if the URL already exists in the history
            const existingIndex = this.urlHistory.indexOf(url);
            if (existingIndex !== -1) {
              // Remove the existing URL to avoid duplicates
              this.urlHistory.splice(existingIndex, 1);
            }

            // Add the URL to the beginning of the history array
            this.urlHistory.unshift(url);

            // Keep only the last 20 entries
            if (this.urlHistory.length > 20) {
              this.urlHistory.pop();
            }

            // Save the updated history in localStorage
            localStorage.setItem("urlHistory", JSON.stringify(this.urlHistory));
          },
          removeFromHistory(url) {
            // Remove the URL from history
            this.urlHistory = this.urlHistory.filter((item) => item !== url);

            // Save the updated history to localStorage
            localStorage.setItem("urlHistory", JSON.stringify(this.urlHistory));
          },
          fillAndDownload(url) {
            // Fill the form with the selected URL and trigger the download process
            this.postUrl = url;
            this.processVideo();
          },
          async processVideo() {
            this.resetState();

            const postUrl = this.postUrl;

            this.status = "Initializing...";
            this.downloadLink = "";
            this.downloadReady = false;
            this.videoPreviewVisible = false;

            try {
              const { profile, post } = this.extractProfileAndPost(postUrl);
              const threadRes = await fetch(`
                https://public.api.bsky.app/xrpc/app.bsky.feed.getPostThread?uri=at://${profile}/app.bsky.feed.post/${post}&depth=10
              `);
              const data = await threadRes.json();

              let playlistUrl;

              if (
                data.thread.post.embed["$type"] === "app.bsky.embed.video#view"
              ) {
                playlistUrl = data.thread.post.embed.playlist;
              } else if (
                data.thread.post.embed["$type"] ===
                "app.bsky.embed.recordWithMedia#view"
              ) {
                playlistUrl = data.thread.post.embed.media.playlist;
              }

              this.status = "Downloading...";
              this.progressBarVisible = true;

              const [videoBlob] = await Promise.all([
                this.proccessPlaylist(playlistUrl),
                this.ffmpeg.isLoaded() ? Promise.resolve() : this.ffmpeg.load(),
              ]);

              this.status = "Processing...";

              this.originalDownloadLink = URL.createObjectURL(videoBlob);

              this.status = "Converting to mp4...";

              this.ffmpeg.FS(
                "writeFile",
                "input.ts",
                await fetchFile(videoBlob)
              );

              await this.ffmpeg.run(
                "-i",
                "input.ts",
                "-map",
                "0",
                "-c",
                "copy",
                `video-${post}.mp4`
              );
              this.progress = 100;

              const videoData = this.ffmpeg.FS("readFile", `video-${post}.mp4`);
              const mp4Blob = new Blob([videoData.buffer], {
                type: "video/mp4",
              });

              this.downloadLink = URL.createObjectURL(mp4Blob);
              this.downloadReady = true;
              this.progressBarVisible = false;
              this.videoPreviewVisible = true;
              this.status = "";

              // Save the current URL to the history
              this.saveToHistory(this.postUrl);
            } catch (error) {
              this.status = "Downloading...";
              const { profile, post } = this.extractProfileAndPost(
                this.postUrl
              );
              const threadRes = await fetch(
                `https://public.api.bsky.app/xrpc/app.bsky.feed.getPostThread?uri=at://${profile}/app.bsky.feed.post/${post}&depth=10`
              );
              const data = await threadRes.json();

              let playlistUrl;

              if (
                data.thread.post.embed["$type"] === "app.bsky.embed.video#view"
              ) {
                playlistUrl = data.thread.post.embed.playlist;
              } else if (
                data.thread.post.embed["$type"] ===
                "app.bsky.embed.recordWithMedia#view"
              ) {
                playlistUrl = data.thread.post.embed.media.playlist;
              }

              const videoBlob = this.proccessPlaylist(playlistUrl);
              this.originalDownloadLink = URL.createObjectURL(videoBlob);

              this.status =
                error.message || "An error occurred. Please try again.";

              if (this.status === "Out of memory")
                this.status =
                  "Your device is out of memory to convert the file. Please close other tabs and/or apps and try again later.";
            }
          },
          extractProfileAndPost(postUrl) {
            const regex = /profile\/([^\/]+)\/post\/([^\/]+)/;
            const matches = postUrl.match(regex);
            if (!matches) throw new Error("Invalid URL format");
            return { profile: matches[1], post: matches[2] };
          },
          async proccessPlaylist(playlistUrl) {
            const masterPlaylistResponse = await fetch(playlistUrl);
            const masterPlaylist = await masterPlaylistResponse.text();

            await this.setSubtitleUrl(
              playlistUrl,
              this.extractSubtitleLang(masterPlaylist)
            );

            const videoPlaylistUrl = this.parseHighestQualityVideoUrl(
              masterPlaylist,
              playlistUrl
            );
            const videoPlaylistResponse = await fetch(videoPlaylistUrl);
            const videoPlaylist = await videoPlaylistResponse.text();
            const segmentUrls = this.parseSegmentUrls(
              videoPlaylist,
              videoPlaylistUrl
            );

            return this.downloadSegments(segmentUrls);
          },
          extractSubtitleLang(m3u8Content) {
            // Split the content by lines
            const lines = m3u8Content.split("\n");

            // Loop through lines to find the subtitle information
            for (const line of lines) {
              if (
                line.startsWith("#EXT-X-MEDIA") &&
                line.includes("TYPE=SUBTITLES")
              ) {
                // Extract the LANGUAGE value using a regular expression
                const langMatch = line.match(/LANGUAGE="([^"]+)"/);

                if (langMatch) {
                  return langMatch[1]; // Return the extracted language
                }
              }
            }

            return null; // Return null if no subtitle found
          },
          async setSubtitleUrl(playlistUrl, lang) {
            this.subtitleLang = lang;

            if (lang) {
              this.subtitleUrl = await this.convertUrlToBlobUrl(
                `${playlistUrl.replace(
                  "playlist.m3u8",
                  ""
                )}subtitles/${lang}.vtt`
              );
            }
          },
          parseHighestQualityVideoUrl(masterPlaylist, baseUrl) {
            let highestBandwidth = 0;
            let highestQualityUrl = "";
            masterPlaylist.split("\n").forEach((line, i, lines) => {
              if (line.startsWith("#EXT-X-STREAM-INF")) {
                const bandwidth = parseInt(line.match(/BANDWIDTH=(\d+)/)[1]);
                if (bandwidth > highestBandwidth) {
                  highestBandwidth = bandwidth;
                  highestQualityUrl = lines[i + 1];
                }
              }
            });
            return new URL(highestQualityUrl, baseUrl).toString();
          },
          parseSegmentUrls(videoPlaylist, baseUrl) {
            return videoPlaylist
              .split("\n")
              .filter((line) => !line.startsWith("#") && line.trim() !== "")
              .map((segment) => new URL(segment, baseUrl).toString());
          },
          async downloadSegments(segmentUrls) {
            const chunks = [];
            for (let i = 0; i < segmentUrls.length; i++) {
              const response = await fetch(segmentUrls[i]);
              chunks.push(await response.arrayBuffer());
              this.progress = ((i + 1) / segmentUrls.length) * 50;
            }
            return new Blob(chunks, { type: "video/MP2T" });
          },
          async convertUrlToBlobUrl(url) {
            try {
              // Fetch the data from the URL
              const response = await fetch(url);

              // Check if the response is successful
              if (!response.ok) {
                throw new Error(
                  `Failed to fetch data from URL: ${response.statusText}`
                );
              }

              // Get the response as a blob
              const blob = await response.blob();

              // Create a Blob URL from the blob
              const blobUrl = URL.createObjectURL(blob);

              // Return the Blob URL
              return blobUrl;
            } catch (error) {
              console.error("Error converting URL to Blob URL:", error);
            }
          },
          resetState() {
            this.status = "";
            this.progress = 0;
            this.progressBarVisible = false;
            this.thumbnailVisible = false;
            this.downloadReady = false;
            this.thumbnailUrl = "";
            this.downloadLink = "";
            this.playlistUrl = "";
            this.subtitleLang = "";
            this.originalDownloadLink = "";
          },
        },
      }).mount("#app");
    </script>
  </body>
</html>
